# 地图生成系统优化计划

## 1. 修改 MapGenerator 类基础架构
- 添加随机种子支持，确保地图可复现
- 修改构造函数，增加 seed 参数
- 实现基于种子的随机数生成器

## 2. 实现地平线初始地图
- 大地图中央定义为地平线（height/2）
- 初始状态：地平线以下（y > height/2）都是地块（1），地平线以上（y <= height/2）都是空块（0）
- 替换现有的 generateBaseTerrain 方法

## 3. 设计后处理器架构
- 创建后处理器基类或接口
- 实现后处理器链，按顺序执行各个后处理器
- 每个后处理器接收相同的随机种子，确保复现性
- 添加后处理器管理方法

## 4. 实现山峰与山谷后处理器
- 随机位置指定山峰和山谷
- 抬高山峰的土块和挖空山谷的土块
- 对附近土块进行平滑处理
- 平滑后增加随机起伏

## 5. 实现洞穴后处理器
- 配置不同类型洞穴的大小范围
- 随机生成洞穴，确保洞穴之间不连通且保持间距
- 每个洞穴从随机位置开始向周边随机扩散挖空地块
- 支持大中小三种洞穴类型

## 6. 整合所有功能
- 在 generate 方法中调用新的初始地图生成
- 按顺序执行所有后处理器
- 确保玩家出生点生成逻辑适配新的地图生成方式

## 7. 测试与调整
- 测试不同随机种子下的地图生成
- 确保山峰山谷和洞穴生成效果合理
- 调整参数以获得更好的游戏体验

## 文件修改
- `js/core/MapGenerator.js`：主要修改文件，实现所有优化功能