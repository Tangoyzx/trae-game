# 实现类似泰拉瑞亚的2D游戏

## 项目结构
```
├── index.html          # 游戏主页面
├── css/                # 样式文件
├── js/                 # JavaScript代码
│   ├── core/           # 核心系统
│   │   ├── Component.js     # 组件基类
│   │   ├── Entity.js        # 实体类
│   │   ├── Game.js          # 游戏主类
│   │   ├── Physics.js       # 物理系统
│   │   ├── Renderer.js      # 渲染系统
│   │   ├── Input.js         # 输入系统
│   │   ├── Camera.js        # 相机系统
│   │   └── MapGenerator.js  # 地图生成器
│   ├── components/     # 具体组件
│   │   ├── Transform.js     # 位置组件
│   │   ├── Renderer.js      # 渲染组件
│   │   ├── PlayerInput.js   # 玩家输入组件
│   │   ├── PhysicsBody.js   # 物理组件
│   │   ├── AI.js            # AI组件
│   │   └── Movement.js      # 移动组件
│   ├── entities/       # 具体实体
│   │   ├── Player.js        # 玩家
│   │   └── Enemy.js         # 敌人
│   └── main.js         # 游戏入口
└── assets/             # 资源文件
    ├── images/         # 图片资源
    └── sounds/         # 音效资源
```

## 实现步骤

### 1. 核心系统实现
- **Component.js**: 实现组件基类，提供生命周期方法
- **Entity.js**: 实现实体类，作为组件的挂载容器
- **Game.js**: 实现游戏主类，管理游戏循环和实体
- **Input.js**: 实现输入系统，处理键盘和鼠标输入

### 2. 物理系统实现
- **Physics.js**: 实现简化的物理碰撞系统
  - 处理动态单位与地形的碰撞
  - 实现重力、速度更新和碰撞检测
  - 按水平和垂直方向分别处理碰撞

### 3. 渲染系统实现
- **Renderer.js (core)**: 实现渲染系统
  - 管理Canvas绘制
  - 按层级渲染实体
- **Renderer.js (component)**: 实现渲染组件
  - 控制实体的渲染属性
- **Camera.js**: 实现相机系统
  - 首帧直接对齐玩家位置
  - 后续帧使用缓动算法平滑居中玩家
  - 边界限制

### 4. 地图生成系统
- **MapGenerator.js**: 实现地图生成算法
  - 基于网格的地图生成
  - 只生成空和土地两种地块类型
  - 土地作为可阻挡地块
  - 连片生成土地，避免零碎地块
  - 确保生成合理的可行走区域
  - 为玩家生成出生点（确保在土地上）

### 5. 组件实现
- **Transform.js**: 实现位置、旋转、缩放控制
- **Renderer.js (component)**: 实现渲染控制
- **PlayerInput.js**: 实现玩家输入处理（AD移动，空格跳跃）
- **PhysicsBody.js**: 实现物理碰撞体
- **AI.js**: 实现敌人AI（向玩家移动）
- **Movement.js**: 实现移动控制

### 6. 实体实现
- **Player.js**: 实现玩家实体，包含必要组件
- **Enemy.js**: 实现敌人实体，包含必要组件

### 7. 游戏逻辑实现
- **main.js**: 实现游戏入口
  - 初始化游戏
  - 生成地图
  - 在土地上创建玩家
  - 在玩家视野外创建敌人
  - 启动游戏循环

### 8. 基本功能测试
- 测试玩家移动和跳跃
- 测试碰撞检测
- 测试敌人AI
- 测试地图生成（确保玩家出生在土地上）
- 测试相机跟随（首帧直接对齐，后续缓动）

## 技术要点

1. **组件化设计**: 采用类似Unity的组件系统，实体作为组件的挂载容器
2. **简化物理**: 使用简化的碰撞逻辑，只处理动态单位与地形的碰撞
3. **网格地图**: 静态物体与网格对齐，动态单位自由移动
4. **相机系统**: 实现首帧直接对齐、后续缓动的相机跟随效果
5. **地图生成**: 设计合理的随机算法，生成连片的土地地形
6. **输入处理**: 实现键盘输入处理，支持玩家移动和跳跃
7. **AI行为**: 实现敌人的基本追踪AI

## 预期效果

- 玩家可以通过AD键左右移动，空格键跳跃
- 敌人在玩家视野外生成，并向玩家移动
- 游戏世界基于网格生成，只有空和土地两种地块类型
- 玩家出生在土地上
- 相机首帧直接对齐玩家，后续平滑跟随
- 物理系统处理碰撞和重力